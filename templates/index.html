<!DOCTYPE html>
<html>
    <head>
        <title>Prediction</title>
    </head>
    <body>
    <center><h1>Sonova Prediction App</h1></center>

        <form action="" onsubmit="sendMessage(event)">
            <center>
            <label for="x_value">x value:</label>
            <input type="number" id="x_value" step=any autocomplete="off"/>
            <label for="y_value">y value: </label>
            <input type="number" id="y_value" step=any autocomplete="off"/>
            <input type="submit" value="Submit">
            </center>
        </form>

        <center>
            <input type="file" id="filename" />
        <input type="button" value="Upload" onclick="sendFile()" />
        </center>

        <ul id='messages'>
        </ul>

        <script>
            var ws = new WebSocket('ws://localhost:8000/ws');

            // receive message back from server and append it to message and show on webpage
            ws.onmessage = function(event) {

                 var messages = document.getElementById('messages')
                 var message = document.createElement('li')
                 var content = document.createTextNode(event.data)
                 console.log("incoming: ", content)
                 message.appendChild(content)
                 messages.appendChild(message)

            };

            // get two inputs and store in json, send json obj to server to process
            function sendMessage(event) {
                var input1 = document.getElementById("x_value")
                var input2 = document.getElementById("y_value")
                console.log(input1.value, input2.value)
                var msg = {
                x_value: input1.value,
                y_value: input2.value,
                };

                ws.send(JSON.stringify(msg));
                // clear two inputs fields
                input1.value = ''
                input2.value = ''
                event.preventDefault()
            }

            function sendFile() {
            var file = document.getElementById('filename').files[0];
            ws.send(file);
            console.log("the File has been transferred.")

        }


        </script>
    </body>
</html>